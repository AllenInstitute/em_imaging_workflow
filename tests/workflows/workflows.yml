executables:
    mock:
        name: 'Mock Executable'
        path: '/projects/mock_bin/mock_executable.sh'
        pbs_queue: 'mindscope'
        pbs_processor: 'vmem=16g'
        pbs_walltime: 'walltime=5:00:00'
run_states:
    - "PENDING"
    - "QUEUED"
    - "RUNNING"
    - "FINISHED_EXECUTION"
    - "FAILED_EXECUTION"
    - "FAILED"
    - "SUCCESS"
    - "PROCESS_KILLED"
workflows:
    lens_correction:
        states:
            - key: "ingest"
              label: "Ingest Reference Set"
              class: "development.strategies.ingest_reference_set_strategy.IngestReferenceSetStrategy"
              enqueued_class: "development.models.ReferenceSet"
              executable: "mock"
            - key: "generate"
              label: "generate_lens_correction_transform"
              class: "development.strategies.ingest_reference_set_strategy.GenerateLensCorrectionTransformStrategy"
              executable: "mock"
            - key: "move"
              label: "move_reference_set_files_to_long_term_storage"
              class: "development.strategies.ingest_reference_set_strategy.MoveReferenceSetStrategy"
              executable: "mock"
        graph:
            - [ "ingest", [ "generate" ] ]
            - [ "generate", [ "move" ] ]
            - [ "move", [] ]
    em_2d_montage:
        states:
            - key: "ingest_generate"
              label: "Ingest / Generate Render Stack"
              class: "development.strategies.ingest_reference_set_strategy.IngestGenerateRenderStackStrategy"
              executable: "mock"
            - key: "mic_task_builder"
              label: "Multiplicative Intensity Correction Task Builder"
              class: "development.strategies.ingest_reference_set_strategy.MICTaskBuilderStrategy"
              executable: "mock"
            - key: "mic_tasks"
              parallel: true
              label: "Multiplicative Intensity Correction Tasks"
              class: "development.strategies.ingest_reference_set_strategy.MICTasksStrategy"
              executable: "mock"
            - key: "generate_mipmaps"
              label: "Generate MipMaps / Write to SAN"
              class: "development.strategies.ingest_reference_set_strategy.GenerateMipMapsStrategy"
              executable: "mock"
            - key: "long_term_storage"
              label: "Move Raw Montage Set Files to Long Term Storage"
              class: "development.strategies.ingest_reference_set_strategy.MoveRawMontageSetStrategy"
              executable: "mock"
            - key: "lens_correction"
              label: "Apply Lens Correction"
              class: "development.strategies.ingest_reference_set_strategy.ApplyLensCorrectionStrategy"
              executable: "mock"
            - key: "2d_montage_point_match"
              label: "2D Montage Point Match"
              class: "development.strategies.ingest_reference_set_strategy.TwoDMontagePointMatchStrategy"
              executable: "mock"
            - key: "solver"
              label: "2D Montage Solver"
              class: "development.strategies.ingest_reference_set_strategy.TwoDMontageSolverStrategy"
              executable: "mock"
            - key: "manual_qc"
              label: "Manual QC / High Degree Polynomial or Point Match Regeneration"
              manual: true
              class: "development.strategies.ingest_reference_set_strategy.ManualQCStrategy"
              executable: "mock"
            - key: "alignment"
              label: "Alignment"
              workflow: true
        graph:
            - [ "ingest_generate", [ "mic_task_builder" ] ]
            - [ "mic_task_builder", [ "mic_tasks" ] ]
            - [ "mic_tasks", [ "generate_mipmaps" ] ]
            - [ "generate_mipmaps", [ "long_term_storage", "lens_correction" ] ]
            - [ "lens_correction", [ "2d_montage_point_match" ] ]
            - [ "2d_montage_point_match", [ "solver" ] ]
            - [ "solver", [ "manual_qc" ] ]
            - [ "manual_qc", [ "alignment" ] ]
    at_2d_montage:
        states:
            - key: "ingest"
              label: "Ingest"
              class: "development.strategies.ingest_reference_set_strategy.Ingest2DMontageStrategy"
              executable: "mock"
            - key: "mic_task_builder"
              label: "Multiplicative Intensity Task Builder"
              executable: "mock"
            - key: "mic_tasks"
              parallel: true
              label: "Multiplicative Intensity Correction Tasks"
              executable: "mock"
            - key: "lens_correction"
              label: "Assign Lens Correction"
              executable: "mock"
            - key: "generate_mipmaps"
              label: "Generate MipMaps / Write to SAN"
              executable: "mock"
            - key: "long_term_storage"
              label: "Transfer Raw Montage Set Files to Long Term Storage"
              executable: "mock"
            - key: "cross_correlation"
              label: "Cross Correlation"
              executable: "mock"
            - key: "montage_qc"
              label: "AT 2D Montage QC"
              executable: "mock"
            - key: "drop_fails"
              label: "Drop Failing Tiles / No Action if Passes QC"
              executable: "mock"
            - key: "stitch"
              label: "Stitch Synthetic Point Matches"
              executable: "mock"
            - key: "registration"
              label: "Registration / No Action w/o Ref Staining Session"
              executable: "mock"
            - key: "assign_z"
              label: "Assign Z"
              manual: true
            - key: "alignment"
              label: "Alignment"
              workflow: true
        graph:
            - [ "ingest", [ "mic_task_builder" ] ]
            - [ "mic_task_builder", [ "mic_tasks" ] ]
            - [ "mic_tasks", [ "lens_correction" ] ]
            - [ "lens_correction", [ "generate_mipmaps" ] ]
            - [ "generate_mipmaps", [ "long_term_storage" ] ]
            - [ "long_term_storage", [ "cross_correlation" ] ]
            - [ "cross_correlation", [ "montage_qc" ] ]
            - [ "montage_qc", [ "drop_fails" ] ]
            - [ "drop_fails", [ "stitch" ] ]
            - [ "stitch", [ "registration" ] ]
            - [ "registration", [ "assign_z" ] ]
            - [ "assign_z", [ "alignment" ] ]
    alignment:
        states:
            - key: "define_chunks"
              label: "Assign Montage Set to Chunk(s)"
              class: "development.strategies.ingest_reference_set_strategy.DefineChunksStrategy"
              executable: "mock"
            - key: "downsample_section_image"
              label: "Downsample Section Image"
              class: "development.strategies.ingest_reference_set_strategy.DownsampleSectionImageStrategy"
              executable: "mock"
            - key: "rough_point_generation"
              label: "Rough Point Match Generation"
              class: "development.strategies.ingest_reference_set_strategy.PointMatchGenerationStrategy"
              executable: "mock"
            - key: "rough_solver"
              label: "Rough Solver"
              class: "development.strategies.ingest_reference_set_strategy.RoughSolverStrategy"
              executable: "mock"
            - key: "rough_qc"
              label: "Rough Alignment QC"
              manual: true
              class: "development.strategies.ingest_reference_set_strategy.RoughQCStrategy"
              executable: "mock"
            - key: "rough_align_application"
              label: "Rough Alignment Application"
              class: "development.strategies.ingest_reference_set_strategy.RoughAlignmentStrategy"
              executable: "mock"
            - key: "fine_point_generation"
              label: "Fine Point Match Generation"
              class: "development.strategies.ingest_reference_set_strategy.FinePointMatchGenerationStrategy"
              executable: "mock"
            - key: "fine_point_match_qc"
              label: "Point Match QC"
              class: "development.strategies.ingest_reference_set_strategy.FineQCStrategy"
              executable: "mock"
            - key: "consolidate"
              label: "Consolidate Transformations in the Stack"
              class: "development.strategies.ingest_reference_set_strategy.ConsolidateStrategy"
              executable: "mock"
            - key: "fine_solver"
              label: "Fine Solver"
              class: "development.strategies.ingest_reference_set_strategy.FineSolverStrategy"
              executable: "mock"
            - key: "fine_align_qc"
              label: "Fine Alignment QC"
              class: "development.strategies.ingest_reference_set_strategy.FineAlignmentQCStrategy"
              executable: "mock"
            - key: "stack_splitter"
              label: "Stack Splitter"
              class: "development.strategies.ingest_reference_set_strategy.StackSplitterStrategy"
              executable: "mock"
            - key: "reversion"
              label: "Stack Split Reversion"
              class: "development.strategies.ingest_reference_set_strategy.StackSplitReversionStrategy"
              executable: "mock"
            - key: "fusion"
              label: "Fusion"
              class: "development.strategies.ingest_reference_set_strategy.FusionStrategy"
              workflow: true
        graph:
            - [ "define_chunks", [ "downsample_section_image" ] ]
            - [ "downsample_section_image", [ "rough_point_generation" ] ]
            - [ "rough_point_generation", [ "rough_solver" ] ]
            - [ "rough_solver", [ "rough_qc" ] ]
            - [ "rough_qc", [ "rough_align_application" ] ]
            - [ "rough_align_application", [ "fine_point_generation" ] ]
            - [ "fine_point_generation", [ "fine_point_match_qc" ] ]
            - [ "fine_point_match_qc", [ "consolidate" ] ]
            - [ "consolidate", [ "fine_solver" ] ]
            - [ "fine_solver", [ "fine_align_qc" ] ]
            - [ "fine_align_qc", [ "stack_splitter" ] ]
            - [ "stack_splitter", [ "reversion" ] ]
            - [ "reversion", [ "fusion" ] ]
    fusion:
        states:
            - key: "ready"
              label: "Adjacent Chunk Ready for Fusing?"
            - key: "register"
              label: "Register Adjacent Chunks"
            - key: "manual_qc"
              label: "Manual QC"
              manual: true
            - key: "manual_global_fusion"
              label: "Manual Global Fusion"
              manual: true
            - key: "render_volume"
              label: "Render Volume"
              manual: true
        graph:
            - [ "ready", [ "register" ] ]
            - [ "register", [ "manual_qc" ] ]
            - [ "manual_qc", [ "manual_global_fusion" ] ]
            - [ "manual_global_fusion", [ "render_volume" ] ]
